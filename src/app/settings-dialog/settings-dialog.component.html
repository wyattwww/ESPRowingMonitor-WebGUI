<h1 mat-dialog-title>Settings</h1>
<div mat-dialog-content>
    <form [formGroup]="settingsForm" (ngSubmit)="submitLoginForm()" novalidate>
        <mat-form-field>
            <mat-label>Web Socket URL</mat-label>
            <input matInput formControlName="websocketAddress" name="websocketAddress" required />
            <mat-error *ngIf="(settingsFormErrors$ | async)?.websocketAddress?.required"
                >URL is required</mat-error
            >
            <mat-error *ngIf="(settingsFormErrors$ | async)?.websocketAddress?.pattern"
                >Invalid URL</mat-error
            >
        </mat-form-field>
        <mat-form-field *ngIf="isSecureContext">
            <mat-label>Heart Rate Monitor</mat-label>
            <mat-select
                name="heartRateMonitor"
                placeholder="Select heart rate monitor mode"
                formControlName="heartRateMonitor"
                required
            >
                <mat-option value="off">off</mat-option>
                <mat-option value="ble">ble</mat-option>
                <mat-option value="ant">ant</mat-option>
            </mat-select>
            <mat-error *ngIf="(settingsFormErrors$ | async)?.heartRateMonitor?.required"
                >Heart rate monitor mode is required</mat-error
            >
            <mat-error *ngIf="(settingsFormErrors$ | async)?.heartRateMonitor?.pattern"
                >Invalid value</mat-error
            >
        </mat-form-field>
        <mat-form-field>
            <mat-label>Log Level</mat-label>
            <mat-select name="logLevel" placeholder="Select log level" formControlName="logLevel" required>
                <mat-option *ngFor="let logLevel of LogLevel | enumToArray" [value]="logLevel.key">{{
                    logLevel.value
                }}</mat-option>
            </mat-select>
            <mat-error *ngIf="(settingsFormErrors$ | async)?.logLevel?.required"
                >Log level is required</mat-error
            >
            <mat-error
                *ngIf="
                    (settingsFormErrors$ | async)?.logLevel?.min ||
                    (settingsFormErrors$ | async)?.logLevel?.max
                "
                >Invalid value</mat-error
            >
        </mat-form-field>
        <mat-form-field>
            <mat-label>Flywheel Inertia</mat-label>
            <input matInput formControlName="flywheelInertia" name="flywheelInertia" required />
            <mat-error *ngIf="(settingsFormErrors$ | async)?.flywheelInertia?.required"
                >Flywheel Inertia is required</mat-error
            >
            <mat-error *ngIf="(settingsFormErrors$ | async)?.flywheelInertia?.min || 
                              (settingsFormErrors$ | async)?.flywheelInertia?.max
            "
                >Invalid value</mat-error
            >
        </mat-form-field>
        <mat-form-field>
            <mat-label>Auto Drag Factor</mat-label>
            <mat-select name="autoDragFactor" placeholder="Enable auto drag factor" formControlName="autoDragFactor" required>
                <mat-option *ngFor="let autoDrag of AutoDragFactor | enumToArray" [value]="autoDrag.key">{{
                    autoDrag.value
                }}</mat-option>
            </mat-select>
            <mat-error *ngIf="(settingsFormErrors$ | async)?.autoDragFactor?.required"
                >Log level is required</mat-error
            >
            <mat-error
                *ngIf="
                    (settingsFormErrors$ | async)?.autoDragFactor?.min ||
                    (settingsFormErrors$ | async)?.autoDragFactor?.max
                "
                >Invalid value</mat-error
            >
        </mat-form-field>
        <mat-form-field>
            <mat-label>Drag Factor</mat-label>
            <input matInput formControlName="dragFactor" name="dragFactor" required />
            <mat-error *ngIf="(settingsFormErrors$ | async)?.dragFactor?.required"
                >Drag Factor is required</mat-error
            >
            <mat-error *ngIf="(settingsFormErrors$ | async)?.dragFactor?.min || 
                              (settingsFormErrors$ | async)?.dragFactor?.max
            "
                >Invalid value</mat-error
            >
        </mat-form-field>
        <mat-form-field>
            <mat-label>Magic Number</mat-label>
            <input matInput formControlName="magicNumber" name="magicNumber" required />
            <mat-error *ngIf="(settingsFormErrors$ | async)?.magicNumber?.required"
                >Magic Number is required</mat-error
            >
            <mat-error *ngIf="(settingsFormErrors$ | async)?.magicNumber?.min || 
                              (settingsFormErrors$ | async)?.magicNumber?.max
            "
                >Invalid value</mat-error
            >
        </mat-form-field>
    </form>
</div>
<div mat-dialog-actions align="end">
    <button
        type="submit"
        (click)="submitLoginForm()"
        mat-raised-button
        mat-dialog-close
        [disabled]="settingsForm.invalid"
    >
        Save
    </button>
    <button mat-raised-button mat-dialog-close>Cancel</button>
</div>
